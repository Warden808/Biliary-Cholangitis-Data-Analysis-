<!DOCTYPE html>
<!-- saved from url=(0063)https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="module" id="truffle-injected" data-runtime="bkkjeefjfjcfdfifddmkdmcpmaakmelp" src="chrome-extension://bkkjeefjfjcfdfifddmkdmcpmaakmelp/contexts/all/injected-script/index.js"></script>


<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Colin Asbill">

<title>Stat131A-Project</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Stat131A-Project_files/clipboard.min.js.download"></script>
<script src="./Stat131A-Project_files/quarto.js.download"></script>
<script src="./Stat131A-Project_files/popper.min.js.download"></script>
<script src="./Stat131A-Project_files/tippy.umd.min.js.download"></script>
<script src="./Stat131A-Project_files/anchor.min.js.download"></script>
<link href="./Stat131A-Project_files/tippy.css" rel="stylesheet">
<link href="./Stat131A-Project_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Stat131A-Project_files/bootstrap.min.js.download"></script>
<link href="./Stat131A-Project_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Stat131A-Project_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Stat131A-Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Colin Asbill </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#background" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Bililary Cholangitis is an autoimmune disease that impacts the liver, by causing the bile ducts to swell and eventually be destroyed, this can lead to cirrhosis and liver failure. Biliary Cholangitis primarily affects women. About 58 out of every 100,000 US women and about 15 out of every 100,000 US men are affected by Biliary Cholangitis. Risk factors include infections such as UTIs(uniary tract infection), chronic cigarette smoking, exposure to toxic chemicals and having a family member with the disease all lead to an increased chance of getting biliary cholangitis.</p>
</section>
<section id="question-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Survival analysis is a part of statistics that studies how long it takes an event to occur, it is useful in studying diseases and estimate the likelihood of death a patient has with a certain illness. The outcome variable of interest in survival analysis is time until an event occurs, this causes the distribution to be typically non normal, with events skewed towards the beginning of the diagnosis. Because survival analysis uses censoring where a subset of the study group will have unknown survival times because of the study ends, before a patient experiences the relevant outcome or if follow up isn’t possible with that patient anymore. This analysis could be helpful in the real world because it can measure the impact of the D-penicillamine drug compared to a placebo. This data could help a company decide if a drug is worth scaling up for mass production if it is an effective drug. Sending an ineffective drug for mass production costs a lot of money and time that could be allocallated towards producing an effective drug that could help people suffering with billary cholangitis.</p>
</section>
</section>
<section id="first-steps" class="level2">
<h2 class="anchored" data-anchor-id="first-steps">First Steps<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#first-steps" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1-1">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-1-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb1-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb1-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-9" aria-hidden="true" tabindex="-1"></a>cho <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"cholangitis.csv"</span>)</span>
<span id="cb1-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-10" aria-hidden="true" tabindex="-1"></a>cho_dict <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"cholangitis_dictionary.csv"</span>)</span>
<span id="cb1-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-11" aria-hidden="true" tabindex="-1"></a>cho <span class="ot">&lt;-</span> cho <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="st">"Unknown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-1" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>status <span class="ot">&lt;-</span> <span class="fu">factor</span>(cho<span class="sc">$</span>status, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"CL"</span>))</span>
<span id="cb2-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-2" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>stage <span class="ot">&lt;-</span> <span class="fu">factor</span>(cho<span class="sc">$</span>stage, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb2-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-3" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>drug <span class="ot">&lt;-</span><span class="fu">factor</span>(cho<span class="sc">$</span>drug, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"D-penicillamine"</span>, <span class="st">"Unknown"</span>))</span>
<span id="cb2-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-4" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(cho<span class="sc">$</span>sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>))</span>
<span id="cb2-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-5" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>ascites <span class="ot">&lt;-</span><span class="fu">factor</span>(cho<span class="sc">$</span>ascites, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"N"</span>))</span>
<span id="cb2-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-6" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>hepatomegaly <span class="ot">&lt;-</span> <span class="fu">factor</span>(cho<span class="sc">$</span>hepatomegaly, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"N"</span>))</span>
<span id="cb2-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-7" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>spiders <span class="ot">&lt;-</span> <span class="fu">factor</span>(cho<span class="sc">$</span>spiders, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"N"</span>))</span>
<span id="cb2-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb2-8" aria-hidden="true" tabindex="-1"></a>cho<span class="sc">$</span>edema <span class="ot">&lt;-</span> <span class="fu">factor</span>(cho<span class="sc">$</span>edema, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"N"</span>, <span class="st">"S"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-2-1" class="level3">
<h3 class="anchored" data-anchor-id="question-2-1">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-2-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb3-1" aria-hidden="true" tabindex="-1"></a>cho <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bilirubin )) <span class="sc">+</span></span>
<span id="cb3-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb4-1" aria-hidden="true" tabindex="-1"></a>cho <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> alk_phos)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb5-1" aria-hidden="true" tabindex="-1"></a>cho <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cholesterol )) <span class="sc">+</span></span>
<span id="cb5-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb7-1" aria-hidden="true" tabindex="-1"></a>cho <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sgot)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-3-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb8-1" aria-hidden="true" tabindex="-1"></a>cho_filtered <span class="ot">&lt;-</span> cho <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bilirubin <span class="sc">&lt;</span> <span class="dv">15</span>, alk_phos <span class="sc">&lt;</span> <span class="dv">5000</span>, cholesterol <span class="sc">&lt;</span> <span class="dv">1000</span>, sgot <span class="sc">&lt;</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Created a bunch of boxplots to find outliers in the dataset and then filtered them out, only kept the boxplots of variables I filtered.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb9-1" aria-hidden="true" tabindex="-1"></a>cho_filtered <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> n_days)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> drug)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Days in Study (By Drug)"</span>, <span class="at">x =</span> <span class="st">"Patient ID Number"</span>, <span class="at">y =</span> <span class="st">"Number of Days in Study"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on this graph its hard to determine if the drug has an effect on the number of days a patient lasts in the study, but we can see that all the “NA” patients had IDs greater than 300 and if we look in the data table we can see that patients 313-418 are NA and did not receive placebo or “D-penicillamine”. It might be a good idea to filter out this NA data by filtering out patients 313-418 to measure the impact of the drug on n_days.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb10-1" aria-hidden="true" tabindex="-1"></a>cho_filtered <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> n_days)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> status)) <span class="sc">+</span></span>
<span id="cb10-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Days in Study (By Status)"</span>, <span class="at">x =</span> <span class="st">"Patient ID Number"</span>, <span class="at">y =</span> <span class="st">"Number of Days in Study"</span>, <span class="at">color =</span> <span class="st">"Status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this graph we can see a similar sloping line as in the first graph where patients are exiting the study this sloping line starts around Patient 100 and ends just past patient 300. One explanation could be these patients entered the study later than earlier patients, so they are all exiting the study because the study ended causing this sloping line of patients that were not dead at the end of the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-1" aria-hidden="true" tabindex="-1"></a>cho_num <span class="ot">&lt;-</span> cho_filtered <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, n_days, age, bilirubin, albumin, copper, alk_phos, sgot, platelets, prothrombin)</span>
<span id="cb11-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">cor</span>(cho_num)) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Variables_1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Variables_1), <span class="at">names_to =</span> <span class="st">"Variables_2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Variables_1, <span class="at">y =</span> Variables_2)) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb11-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb11-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb11-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cho Numeric Varible Correlation Heat Map"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is a correlation heat map of all the numerical variables, we don’t any extremely strong correlations, but we do see that copper, bilirubin and alk_phos have some correlation and more importantly that n_days has correlation with albumin, alk_phos and platelets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb12-1" aria-hidden="true" tabindex="-1"></a>cho_filtered <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(n_days, status, drug) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="fu">aes</span>(<span class="at">color =</span> status))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on this pairs plot we can see that patients that take the drug seem to take slightly longer to die compared to patients that received the placebo, we can also see that most deaths occur within the first 2000 days of the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb14-1" aria-hidden="true" tabindex="-1"></a>cho_med <span class="ot">&lt;-</span> cho_filtered<span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">above_median =</span> n_days <span class="sc">&gt;</span> <span class="fu">median</span>(n_days))</span>
<span id="cb14-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb14-3" aria-hidden="true" tabindex="-1"></a>cho_med <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> drug, <span class="at">fill =</span> above_median)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Patients length in Study, based on Drug assignment"</span>, <span class="at">x =</span> <span class="st">"Drug"</span>, <span class="at">y =</span> <span class="st">"Number of Patients"</span>, <span class="at">fill =</span> <span class="st">"Above Median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This bar chart shows us the numbers of Patients that survived above the median number of days in the study categorized by Drug given. Based on these graphs we can see that slightly more D-penicillamine patients survived past the median than Placebo patients, but both last longer than NA patients who mostly stayed less than the median number of days in the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(cho_filtered<span class="sc">$</span>n_days, <span class="fl">0.25</span>)</span>
<span id="cb15-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-2" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(cho_filtered<span class="sc">$</span>n_days, <span class="fl">0.75</span>)</span>
<span id="cb15-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-3" aria-hidden="true" tabindex="-1"></a>IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb15-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-5" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb15-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-6" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb15-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-8" aria-hidden="true" tabindex="-1"></a>cho_quant <span class="ot">&lt;-</span> cho_filtered[cho_filtered<span class="sc">$</span>n_days <span class="sc">&gt;=</span> lower <span class="sc">&amp;</span> cho_filtered<span class="sc">$</span>n_days <span class="sc">&lt;=</span> upper,]</span>
<span id="cb15-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cho_quant, <span class="fu">aes</span>(<span class="at">x =</span> n_days)) <span class="sc">+</span></span>
<span id="cb15-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb15-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quantile Density Plot of N_days"</span>,</span>
<span id="cb15-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span> <span class="st">"Number of Days in Study"</span>,</span>
<span id="cb15-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb15-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Density is not normally distributed, is concentrated between 0 and 3000, peaking around 1400 days.</p>
</section>
</section>
<section id="explanatory-modeling" class="level2">
<h2 class="anchored" data-anchor-id="explanatory-modeling">Explanatory Modeling<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#explanatory-modeling" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-3" class="level3">
<h3 class="anchored" data-anchor-id="question-3">Question 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-3" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb16-1" aria-hidden="true" tabindex="-1"></a>cho_filtered <span class="ot">&lt;-</span> cho_filtered <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() </span>
<span id="cb16-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb16-3" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span>. <span class="sc">-</span>id,  <span class="at">data =</span> cho_filtered)</span>
<span id="cb16-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = n_days ~ . - id, data = cho_filtered)

Residuals:
     Min       1Q   Median       3Q      Max 
-2409.79  -598.74   -31.66   554.74  2300.43 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -1.992e+03  1.095e+03  -1.818 0.070308 .  
statusD             -5.078e+02  1.514e+02  -3.353 0.000932 ***
statusCL            -5.858e+02  2.271e+02  -2.579 0.010503 *  
drugD-penicillamine  3.278e+00  1.111e+02   0.029 0.976497    
age                 -6.172e-03  1.663e-02  -0.371 0.710961    
sexM                 7.846e+01  1.891e+02   0.415 0.678601    
ascitesN            -5.772e+01  3.067e+02  -0.188 0.850907    
hepatomegalyN       -1.934e-01  1.290e+02  -0.001 0.998805    
spidersN             3.066e+01  1.386e+02   0.221 0.825152    
edemaN               3.964e+02  3.312e+02   1.197 0.232641    
edemaS               1.164e+02  3.497e+02   0.333 0.739521    
bilirubin           -7.784e+01  2.872e+01  -2.710 0.007213 ** 
cholesterol          1.324e-02  4.967e-01   0.027 0.978759    
albumin              5.552e+02  1.618e+02   3.432 0.000707 ***
copper              -1.994e+00  8.213e-01  -2.428 0.015941 *  
alk_phos             1.287e-01  9.409e-02   1.368 0.172513    
sgot                 3.519e-01  1.401e+00   0.251 0.801939    
tryglicerides        1.528e+00  1.138e+00   1.343 0.180685    
platelets            7.756e-01  6.735e-01   1.151 0.250706    
prothrombin          2.086e+02  6.802e+01   3.067 0.002415 ** 
stage2              -3.487e+02  2.738e+02  -1.274 0.204043    
stage3              -3.987e+02  2.710e+02  -1.471 0.142513    
stage4              -6.055e+02  2.931e+02  -2.066 0.039940 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 849.4 on 236 degrees of freedom
Multiple R-squared:  0.4092,    Adjusted R-squared:  0.3541 
F-statistic:  7.43 on 22 and 236 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Firstly I filtered out outliers and the patients that had drug status as NA, so that we could measure the impact of D-pencillamine on n_days. I also changed all the categorical variables into factors as instructed, so the first level will be included in the baseline and therefore is missing from the regression table. We can see that statusD and albumin are statistically significant to the 1% level, bilirubin and prothrombin are significant to the 5% level, statusCL, copper and stage 4 are significant to the 10% level. Now I’m gonna look at the p.values and cooks distance to eliminate some high influence points and run a new regression with the cleaned data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb18-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(df, df.residual, statistic, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
     df df.residual statistic  p.value
  &lt;dbl&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1    22         236      7.43 3.62e-17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb20-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, statistic, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
   term                   estimate std.error statistic  p.value
   &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)         -1992.      1095.      -1.82    0.0703  
 2 statusD              -508.       151.      -3.35    0.000932
 3 statusCL             -586.       227.      -2.58    0.0105  
 4 drugD-penicillamine     3.28     111.       0.0295  0.976   
 5 age                    -0.00617    0.0166  -0.371   0.711   
 6 sexM                   78.5      189.       0.415   0.679   
 7 ascitesN              -57.7      307.      -0.188   0.851   
 8 hepatomegalyN          -0.193    129.      -0.00150 0.999   
 9 spidersN               30.7      139.       0.221   0.825   
10 edemaN                396.       331.       1.20    0.233   
# ℹ 13 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm1, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            2.5 %        97.5 %
(Intercept)         -4.149999e+03  166.41502089
statusD             -8.061071e+02 -209.39680885
statusCL            -1.033140e+03 -138.37778015
drugD-penicillamine -2.156908e+02  222.24667097
age                 -3.894203e-02    0.02659902
sexM                -2.940973e+02  451.01481603
ascitesN            -6.620115e+02  546.57546920
hepatomegalyN       -2.542874e+02  253.90057093
spidersN            -2.424079e+02  303.71878384
edemaN              -2.561790e+02 1048.92541924
edemaS              -5.724820e+02  805.28042390
bilirubin           -1.344259e+02  -21.26305542
cholesterol         -9.653584e-01    0.99183792
albumin              2.365336e+02  873.95929135
copper              -3.612136e+00   -0.37593946
alk_phos            -5.661622e-02    0.31409767
sgot                -2.409065e+00    3.11294496
tryglicerides       -7.141702e-01    3.77056114
platelets           -5.513685e-01    2.10250951
prothrombin          7.460875e+01  342.61303283
stage2              -8.881459e+02  190.68488966
stage3              -9.325641e+02  135.12595914
stage4              -1.183022e+03  -28.05849756</code></pre>
</div>
</div>
<p>The p-value is close to zero, so we can conclude that at least one coefficient is non zero. The confidence intervals are pretty wide which introduces a lot of variance into the regression making it hard to find the impact of each variable, lets eliminate some high influence points to improve this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb24-1" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(lm1)</span>
<span id="cb24-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cooksd, <span class="at">type=</span><span class="st">"h"</span>, <span class="at">main=</span><span class="st">"Cook's Distance"</span>, <span class="at">ylab=</span><span class="st">"Cook's Distance"</span>)</span>
<span id="cb24-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">4</span><span class="sc">/</span>(<span class="fu">nrow</span>(cho_filtered)), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb25-1" aria-hidden="true" tabindex="-1"></a>cho_filtered <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cooksd =</span> <span class="fu">cooks.distance</span>(lm1)) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cooksd <span class="sc">&gt;</span> <span class="fl">0.02</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, n_days, status, drug)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    id n_days status            drug
1   19   4232      C D-penicillamine
2   44   3428      D         Placebo
3   51   3853      D         Placebo
4   60   4365      C D-penicillamine
5   62   3090      D         Placebo
6   66   4191      D D-penicillamine
7   81   2540      D D-penicillamine
8   83   4050      C D-penicillamine
9   87    198      D D-penicillamine
10  97    611      D         Placebo
11 103    110      D         Placebo
12 107   3388      C         Placebo
13 121    191      D         Placebo
14 154    140      D D-penicillamine
15 253   1765      C D-penicillamine</code></pre>
</div>
</div>
<p>Most of the values with high cooks distance are between 19 and 97 as the Patient ID number, is there something different about the first 100 patients compared to the rest? Now I will use the cooks distance to make a graph of the high influence points in a fitted vs residuals plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">length</span>(cooksd)</span>
<span id="cb27-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> cooksd <span class="sc">&gt;</span> threshold</span>
<span id="cb27-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-5" aria-hidden="true" tabindex="-1"></a>residuals_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FittedValues =</span> <span class="fu">fitted</span>(lm1),</span>
<span id="cb27-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Residuals =</span> <span class="fu">residuals</span>(lm1),</span>
<span id="cb27-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">HighInfluence =</span> outliers</span>
<span id="cb27-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals_df, <span class="fu">aes</span>(<span class="at">x =</span> FittedValues, <span class="at">y =</span> Residuals)) <span class="sc">+</span></span>
<span id="cb27-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> HighInfluence), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb27-15"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Fitted Plot with High Influence Points"</span>,</span>
<span id="cb27-16"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb27-17"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb27-18"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"High Influence"</span>) <span class="sc">+</span></span>
<span id="cb27-19"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot identifies some high influence points that could be impacting the data, so I’m gonna remove these points and run a new regression with the cleaned data to try and improve the regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb28-1" aria-hidden="true" tabindex="-1"></a>cho_cleaned <span class="ot">&lt;-</span> cho[<span class="sc">!</span>outliers,]</span>
<span id="cb28-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb28-2" aria-hidden="true" tabindex="-1"></a>cho_cleaned <span class="ot">&lt;-</span> cho_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb28-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb28-4" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span>. <span class="sc">-</span>id, <span class="at">data =</span> cho_cleaned)</span>
<span id="cb28-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = n_days ~ . - id, data = cho_filtered)

Residuals:
     Min       1Q   Median       3Q      Max 
-2409.79  -598.74   -31.66   554.74  2300.43 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -1.992e+03  1.095e+03  -1.818 0.070308 .  
statusD             -5.078e+02  1.514e+02  -3.353 0.000932 ***
statusCL            -5.858e+02  2.271e+02  -2.579 0.010503 *  
drugD-penicillamine  3.278e+00  1.111e+02   0.029 0.976497    
age                 -6.172e-03  1.663e-02  -0.371 0.710961    
sexM                 7.846e+01  1.891e+02   0.415 0.678601    
ascitesN            -5.772e+01  3.067e+02  -0.188 0.850907    
hepatomegalyN       -1.934e-01  1.290e+02  -0.001 0.998805    
spidersN             3.066e+01  1.386e+02   0.221 0.825152    
edemaN               3.964e+02  3.312e+02   1.197 0.232641    
edemaS               1.164e+02  3.497e+02   0.333 0.739521    
bilirubin           -7.784e+01  2.872e+01  -2.710 0.007213 ** 
cholesterol          1.324e-02  4.967e-01   0.027 0.978759    
albumin              5.552e+02  1.618e+02   3.432 0.000707 ***
copper              -1.994e+00  8.213e-01  -2.428 0.015941 *  
alk_phos             1.287e-01  9.409e-02   1.368 0.172513    
sgot                 3.519e-01  1.401e+00   0.251 0.801939    
tryglicerides        1.528e+00  1.138e+00   1.343 0.180685    
platelets            7.756e-01  6.735e-01   1.151 0.250706    
prothrombin          2.086e+02  6.802e+01   3.067 0.002415 ** 
stage2              -3.487e+02  2.738e+02  -1.274 0.204043    
stage3              -3.987e+02  2.710e+02  -1.471 0.142513    
stage4              -6.055e+02  2.931e+02  -2.066 0.039940 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 849.4 on 236 degrees of freedom
Multiple R-squared:  0.4092,    Adjusted R-squared:  0.3541 
F-statistic:  7.43 on 22 and 236 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = n_days ~ . - id, data = cho_cleaned)

Residuals:
     Min       1Q   Median       3Q      Max 
-2159.65  -539.68     8.34   514.19  2304.33 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -998.38631  964.88061  -1.035 0.301766    
statusD             -637.98478  135.27334  -4.716 3.94e-06 ***
statusCL            -634.04695  218.74681  -2.899 0.004071 ** 
drugD-penicillamine   32.46150  103.47196   0.314 0.753985    
age                   -0.00521    0.01533  -0.340 0.734188    
sexM                 206.38705  176.36986   1.170 0.243002    
ascitesN             227.85005  263.98096   0.863 0.388867    
hepatomegalyN         34.98434  121.77250   0.287 0.774119    
spidersN               1.23816  124.97060   0.010 0.992103    
edemaN               191.92093  280.56329   0.684 0.494554    
edemaS               122.71609  290.14982   0.423 0.672691    
bilirubin            -46.64807   16.53524  -2.821 0.005158 ** 
cholesterol           -0.07490    0.25834  -0.290 0.772105    
albumin              553.31390  146.95818   3.765 0.000206 ***
copper                -1.69089    0.71926  -2.351 0.019483 *  
alk_phos               0.13380    0.02561   5.224 3.61e-07 ***
sgot                   0.41140    1.04931   0.392 0.695334    
tryglicerides          1.25493    0.88880   1.412 0.159172    
platelets              0.29948    0.58631   0.511 0.609938    
prothrombin          110.49431   61.13512   1.807 0.071868 .  
stage2              -217.57303  246.28813  -0.883 0.377838    
stage3              -399.38948  241.20043  -1.656 0.098970 .  
stage4              -579.00203  260.75265  -2.221 0.027254 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 827.8 on 258 degrees of freedom
Multiple R-squared:  0.4849,    Adjusted R-squared:  0.441 
F-statistic: 11.04 on 22 and 258 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>From this regression we can see that the degrees of freedom have increased from 236 to 258 and the residual standard error has decreased from 849 to 827. We can also see that the statistical significance of the variables has changed with alk_phos becoming significant to the 1% level now. This regression looks more accurate than the first one so removing the high influence points seems to have helped. The estimates have less variance in their numbers no longer needing scientific notion in the second regression.</p>
</section>
<section id="question-4" class="level3">
<h3 class="anchored" data-anchor-id="question-4">Question 4<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-4" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Now I will check that this cleaned data passes the assumptions using several different diagnostic plots to check the Linearity, Homosexuality and Normality of the error terms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-1" aria-hidden="true" tabindex="-1"></a>cho_cleaned<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm2)</span>
<span id="cb32-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-2" aria-hidden="true" tabindex="-1"></a>cho_cleaned<span class="sc">$</span>fitted_values <span class="ot">&lt;-</span> <span class="fu">fitted</span>(lm2)</span>
<span id="cb32-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-3" aria-hidden="true" tabindex="-1"></a>cho_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fitted_values, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Fitted Plot"</span>,</span>
<span id="cb32-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb32-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb32-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Residuals seem to be symmetrically distributed around the center line, but the linear relationship is valid, so linearity is good. The variance seems to increase with the fitted values which violates homoscedasticity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-1" aria-hidden="true" tabindex="-1"></a>standard_resids <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(lm2)</span>
<span id="cb33-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-3" aria-hidden="true" tabindex="-1"></a>qq_data <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(standard_resids, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-5" aria-hidden="true" tabindex="-1"></a>qq_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Theoretical =</span> qq_data<span class="sc">$</span>x, <span class="at">StandardizedResiduals =</span> qq_data<span class="sc">$</span>y)</span>
<span id="cb33-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qq_df, <span class="fu">aes</span>(<span class="at">x =</span> Theoretical, <span class="at">y =</span> StandardizedResiduals)) <span class="sc">+</span></span>
<span id="cb33-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Standardized Residuals"</span>,</span>
<span id="cb33-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb33-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb33-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Standardized Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the QQ plot we can see that the residuals are normally distributed, with the exception of a few outliers near the tails, but overall seems to be fulfill the normality of error terms requirment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-1" aria-hidden="true" tabindex="-1"></a>sqrt_std_residuals <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">rstandard</span>(lm2)))</span>
<span id="cb34-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-3" aria-hidden="true" tabindex="-1"></a>scale_location_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FittedValues =</span> <span class="fu">fitted</span>(lm2),</span>
<span id="cb34-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SqrtStdResiduals =</span> sqrt_std_residuals</span>
<span id="cb34-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scale_location_df, <span class="fu">aes</span>(<span class="at">x =</span> FittedValues, <span class="at">y =</span> SqrtStdResiduals)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb34-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scale-Location Plot"</span>,</span>
<span id="cb34-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb34-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sqrt(Standardized Residuals)"</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There still seems to be a slight heteroscedasticity/variance problem with the data increasing in variance with the fitted values. So the constant variance for error terms assumption is violated.</p>
</section>
<section id="question-5" class="level3">
<h3 class="anchored" data-anchor-id="question-5">Question 5<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-5" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb36-1" aria-hidden="true" tabindex="-1"></a> lm2 <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, statistic, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
   term                  estimate std.error statistic    p.value
   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 (Intercept)         -998.       965.      -1.03    0.302     
 2 statusD             -638.       135.      -4.72    0.00000394
 3 statusCL            -634.       219.      -2.90    0.00407   
 4 drugD-penicillamine   32.5      103.       0.314   0.754     
 5 age                   -0.00521    0.0153  -0.340   0.734     
 6 sexM                 206.       176.       1.17    0.243     
 7 ascitesN             228.       264.       0.863   0.389     
 8 hepatomegalyN         35.0      122.       0.287   0.774     
 9 spidersN               1.24     125.       0.00991 0.992     
10 edemaN               192.       281.       0.684   0.495     
# ℹ 13 more rows</code></pre>
</div>
</div>
<p>The p-value of the drug D-penicillamine variable is 0.75, which is close 1, this means that you can not reject the null hypothesis that D-Pencilliamine is not equal to the baseline (Placebo). That means the effect of the drug increasing patient survival by about 32 days could be attributed to randomness as the drug is not statistically different from the effect of the Placebo.</p>
</section>
</section>
<section id="predictive-modeling" class="level2">
<h2 class="anchored" data-anchor-id="predictive-modeling">Predictive Modeling<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#predictive-modeling" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-6" class="level3">
<h3 class="anchored" data-anchor-id="question-6">Question 6<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-6" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb38-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-2" aria-hidden="true" tabindex="-1"></a>train_pct <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb38-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-3" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="fu">nrow</span>(cho_cleaned), <span class="at">by =</span><span class="dv">1</span>)</span>
<span id="cb38-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-4" aria-hidden="true" tabindex="-1"></a>training_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> indices, <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb38-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="fu">nrow</span>(cho_cleaned)<span class="sc">*</span>train_pct)</span>
<span id="cb38-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-6" aria-hidden="true" tabindex="-1"></a>cho_train <span class="ot">&lt;-</span> cho_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(training_indices)</span>
<span id="cb38-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-8" aria-hidden="true" tabindex="-1"></a>cho_test <span class="ot">&lt;-</span> cho_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span>training_indices)</span>
<span id="cb38-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-11" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm2, cho_test)</span>
<span id="cb38-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-13" aria-hidden="true" tabindex="-1"></a>mse_test <span class="ot">&lt;-</span> <span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MSE on the test set is:"</span>, mse_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MSE on the test set is: 741855.59204845"</code></pre>
</div>
</div>
<p>0.8 808599.584 0.75 773683.87 0.7 741855.59 The rule of thumb for train/test split seems to be 80/20 train/test, but in the slides and discussion we used a 70/30 split, so I tested a split of 70, 75, and 80 and 0.7 was had the smallest MSE, so I choose 70/30 as the train test split.</p>
</section>
<section id="question-7" class="level3">
<h3 class="anchored" data-anchor-id="question-7">Question 7<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-7" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb40-1" aria-hidden="true" tabindex="-1"></a>forward <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(n_days <span class="sc">~</span> . <span class="sc">-</span>id <span class="sc">-</span>residuals <span class="sc">-</span>fitted_values, <span class="at">data =</span> cho_cleaned, <span class="at">method =</span> <span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax, force.in =
force.in, : 1 linear dependencies found</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Reordering variables and trying again:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(n_days ~ . - id - residuals - fitted_values, 
    data = cho_cleaned, method = "forward")
23 Variables  (and intercept)
                    Forced in Forced out
statusD                 FALSE      FALSE
statusCL                FALSE      FALSE
drugD-penicillamine     FALSE      FALSE
age                     FALSE      FALSE
sexM                    FALSE      FALSE
ascitesN                FALSE      FALSE
hepatomegalyN           FALSE      FALSE
spidersN                FALSE      FALSE
edemaN                  FALSE      FALSE
edemaS                  FALSE      FALSE
bilirubin               FALSE      FALSE
cholesterol             FALSE      FALSE
albumin                 FALSE      FALSE
copper                  FALSE      FALSE
alk_phos                FALSE      FALSE
sgot                    FALSE      FALSE
tryglicerides           FALSE      FALSE
platelets               FALSE      FALSE
prothrombin             FALSE      FALSE
stage2                  FALSE      FALSE
stage3                  FALSE      FALSE
stage4                  FALSE      FALSE
drugUnknown             FALSE      FALSE
1 subsets of each size up to 9
Selection Algorithm: forward
         statusD statusCL drugD-penicillamine drugUnknown age sexM ascitesN
1  ( 1 ) " "     " "      " "                 " "         " " " "  " "     
2  ( 1 ) " "     " "      " "                 " "         " " " "  " "     
3  ( 1 ) " "     " "      " "                 " "         " " " "  " "     
4  ( 1 ) "*"     " "      " "                 " "         " " " "  " "     
5  ( 1 ) "*"     "*"      " "                 " "         " " " "  " "     
6  ( 1 ) "*"     "*"      " "                 " "         " " " "  " "     
7  ( 1 ) "*"     "*"      " "                 " "         " " " "  " "     
8  ( 1 ) "*"     "*"      " "                 " "         " " " "  " "     
9  ( 1 ) "*"     "*"      " "                 " "         " " " "  " "     
         hepatomegalyN spidersN edemaN edemaS bilirubin cholesterol albumin
1  ( 1 ) " "           " "      " "    " "    " "       " "         "*"    
2  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
3  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
4  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
5  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
6  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
7  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
8  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
9  ( 1 ) " "           " "      " "    " "    "*"       " "         "*"    
         copper alk_phos sgot tryglicerides platelets prothrombin stage2 stage3
1  ( 1 ) " "    " "      " "  " "           " "       " "         " "    " "   
2  ( 1 ) " "    " "      " "  " "           " "       " "         " "    " "   
3  ( 1 ) " "    "*"      " "  " "           " "       " "         " "    " "   
4  ( 1 ) " "    "*"      " "  " "           " "       " "         " "    " "   
5  ( 1 ) " "    "*"      " "  " "           " "       " "         " "    " "   
6  ( 1 ) " "    "*"      " "  " "           " "       " "         " "    " "   
7  ( 1 ) "*"    "*"      " "  " "           " "       " "         " "    " "   
8  ( 1 ) "*"    "*"      " "  " "           " "       " "         " "    "*"   
9  ( 1 ) "*"    "*"      " "  " "           " "       "*"         " "    "*"   
         stage4
1  ( 1 ) " "   
2  ( 1 ) " "   
3  ( 1 ) " "   
4  ( 1 ) " "   
5  ( 1 ) " "   
6  ( 1 ) "*"   
7  ( 1 ) "*"   
8  ( 1 ) "*"   
9  ( 1 ) "*"   </code></pre>
</div>
</div>
<p>I did a forward stepwise model to find the best variables to use in a regression now I’ll make 7 models and test the RMSEs of each to find the best model to use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb45-1" aria-hidden="true" tabindex="-1"></a>MLR_model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin, <span class="at">data =</span> cho_train)</span>
<span id="cb45-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb45-2" aria-hidden="true" tabindex="-1"></a>predictions1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model1, cho_test)</span>
<span id="cb45-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb45-4" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions1)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb45-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the first model is:"</span>, rmse1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the first model is: 964.02762920201"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb47-1" aria-hidden="true" tabindex="-1"></a>MLR_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin <span class="sc">+</span> bilirubin, <span class="at">data =</span> cho_train)</span>
<span id="cb47-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb47-2" aria-hidden="true" tabindex="-1"></a>predictions2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model2, cho_test)</span>
<span id="cb47-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb47-4" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions2)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb47-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the second model is:"</span>, rmse2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the second model is: 913.402035287601"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb49-1" aria-hidden="true" tabindex="-1"></a>MLR_model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin <span class="sc">+</span> bilirubin <span class="sc">+</span> alk_phos , <span class="at">data =</span> cho_train)</span>
<span id="cb49-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb49-2" aria-hidden="true" tabindex="-1"></a>predictions3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model3, cho_test)</span>
<span id="cb49-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb49-4" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions3)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb49-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the third model is:"</span>, rmse3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the third model is: 968.974101652939"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb51-1" aria-hidden="true" tabindex="-1"></a>MLR_model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin <span class="sc">+</span> bilirubin <span class="sc">+</span> alk_phos <span class="sc">+</span> status , <span class="at">data =</span> cho_train)</span>
<span id="cb51-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb51-2" aria-hidden="true" tabindex="-1"></a>predictions4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model4, cho_test)</span>
<span id="cb51-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb51-4" aria-hidden="true" tabindex="-1"></a>rmse4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions4)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb51-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the fourth model is:"</span>, rmse4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the fourth model is: 951.157037281773"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb53-1" aria-hidden="true" tabindex="-1"></a>MLR_model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin <span class="sc">+</span> bilirubin <span class="sc">+</span> alk_phos <span class="sc">+</span> status <span class="sc">+</span> stage , <span class="at">data =</span> cho_train)</span>
<span id="cb53-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb53-2" aria-hidden="true" tabindex="-1"></a>predictions5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model5, cho_test)</span>
<span id="cb53-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb53-4" aria-hidden="true" tabindex="-1"></a>rmse5 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions5)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the fifth model is:"</span>, rmse5))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the fifth model is: 929.614993132088"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb55-1" aria-hidden="true" tabindex="-1"></a>MLR_model6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin <span class="sc">+</span> bilirubin <span class="sc">+</span> alk_phos <span class="sc">+</span> status <span class="sc">+</span> stage <span class="sc">+</span> copper , <span class="at">data =</span> cho_train)</span>
<span id="cb55-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb55-2" aria-hidden="true" tabindex="-1"></a>predictions6 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model6, cho_test)</span>
<span id="cb55-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb55-4" aria-hidden="true" tabindex="-1"></a>rmse6 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions6)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb55-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the sixth model is:"</span>, rmse6))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the sixth model is: 927.813058391884"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb57-1" aria-hidden="true" tabindex="-1"></a>MLR_model7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_days <span class="sc">~</span> albumin <span class="sc">+</span> bilirubin <span class="sc">+</span> alk_phos <span class="sc">+</span> status <span class="sc">+</span> stage <span class="sc">+</span> copper <span class="sc">+</span> prothrombin , <span class="at">data =</span> cho_train)</span>
<span id="cb57-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb57-2" aria-hidden="true" tabindex="-1"></a>predictions7 <span class="ot">&lt;-</span> <span class="fu">predict</span>(MLR_model7, cho_test)</span>
<span id="cb57-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb57-4" aria-hidden="true" tabindex="-1"></a>rmse7 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictions7)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb57-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE of the seventh model is:"</span>, rmse7))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE of the seventh model is: 919.755241317159"</code></pre>
</div>
</div>
<p>We can see that the second model has the best RMSE with the variables albumin and bilirubin. The RMSE increased after including alk_phos then decreased with more variables being added but the second model still remained the best even with the seventh model getting close with 919.75 to the second’s 913.4</p>
</section>
<section id="question-8" class="level3">
<h3 class="anchored" data-anchor-id="question-8">Question 8<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-8" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb59-1" aria-hidden="true" tabindex="-1"></a>decision_tree <span class="ot">&lt;-</span> </span>
<span id="cb59-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(n_days <span class="sc">~</span> . <span class="sc">-</span>id <span class="sc">-</span>residuals <span class="sc">-</span>fitted_values, <span class="at">data =</span> cho_train)</span>
<span id="cb59-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(decision_tree, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now I’m gonna use printcp to find out more information about the tree and prune as necessary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(decision_tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression tree:
rpart(formula = n_days ~ . - id - residuals - fitted_values, 
    data = cho_train)

Variables actually used in tree construction:
[1] albumin     alk_phos    bilirubin   cholesterol copper      edema      
[7] prothrombin stage      

Root node error: 238187923/196 = 1215245

n= 196 

         CP nsplit rel error  xerror     xstd
1  0.260358      0   1.00000 1.00788 0.090044
2  0.083480      1   0.73964 0.79850 0.078302
3  0.047289      2   0.65616 0.88528 0.086444
4  0.045635      3   0.60887 0.87166 0.090810
5  0.026037      6   0.47197 0.84742 0.095314
6  0.026026      7   0.44593 0.89149 0.101642
7  0.016810      8   0.41991 0.93213 0.106644
8  0.015312      9   0.40310 0.93867 0.108390
9  0.014710     10   0.38778 0.94459 0.109088
10 0.010274     11   0.37307 0.95733 0.110288
11 0.010000     12   0.36280 0.97465 0.112759</code></pre>
</div>
</div>
<p>We can see that the xerror starts increasing again after the 3rd split, so I will set the cp = 0.045635</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb62-1" aria-hidden="true" tabindex="-1"></a>tree2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(n_days <span class="sc">~</span> . <span class="sc">-</span>id <span class="sc">-</span>residuals <span class="sc">-</span>fitted_values, <span class="at">data =</span> cho_train,</span>
<span id="cb62-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb62-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cp =</span> <span class="fl">0.045635</span>)</span>
<span id="cb62-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(tree2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression tree:
rpart(formula = n_days ~ . - id - residuals - fitted_values, 
    data = cho_train, cp = 0.045635)

Variables actually used in tree construction:
[1] alk_phos  bilirubin stage    

Root node error: 238187923/196 = 1215245

n= 196 

        CP nsplit rel error  xerror     xstd
1 0.260358      0   1.00000 1.00492 0.089524
2 0.083480      1   0.73964 0.80250 0.078483
3 0.047289      2   0.65616 0.86006 0.087587
4 0.045635      3   0.60887 0.89684 0.100867</code></pre>
</div>
</div>
<p>Now the important variables are only alk_phos, bilirubin and stage = 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb65-1" aria-hidden="true" tabindex="-1"></a>predictiontree <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> tree2, <span class="at">newdata =</span> cho_test)</span>
<span id="cb65-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb65-2" aria-hidden="true" tabindex="-1"></a>rmseTree <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictiontree)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb65-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmseTree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1022.586</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb67-1" aria-hidden="true" tabindex="-1"></a>random_forest <span class="ot">&lt;-</span>  </span>
<span id="cb67-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">randomForest</span>(n_days <span class="sc">~</span> . <span class="sc">-</span>id <span class="sc">-</span>residuals <span class="sc">-</span>fitted_values, <span class="at">data =</span> cho_train,</span>
<span id="cb67-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb67-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">cutoff =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb67-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb67-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb67-5" aria-hidden="true" tabindex="-1"></a>random_forest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = n_days ~ . - id - residuals - fitted_values,      data = cho_train, cutoff = c(0.5, 0.5), importance = TRUE) 
               Type of random forest: regression
                     Number of trees: 500
No. of variables tried at each split: 6

          Mean of squared residuals: 719961.5
                    % Var explained: 40.76</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(random_forest, </span>
<span id="cb69-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb69-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Variable Importance Plot"</span>,</span>
<span id="cb69-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb69-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Stat131A-Project_files/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This chart ranks the variables by how much they increase the MSE and how homogeneous each node is we can see that alk_phos and bilirubin remain important variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb70-1" aria-hidden="true" tabindex="-1"></a>predictionrandom <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> random_forest, <span class="at">newdata =</span> cho_test)</span>
<span id="cb70-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb70-2" aria-hidden="true" tabindex="-1"></a>rmseRandomTree <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cho_test<span class="sc">$</span>n_days <span class="sc">-</span> predictionrandom)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb70-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmseRandomTree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 856.7104</code></pre>
</div>
</div>
</section>
<section id="question-9" class="level3">
<h3 class="anchored" data-anchor-id="question-9">Question 9<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-9" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb72-1" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">"Linear Regression"</span>, <span class="st">"Regression Trees"</span>, <span class="st">"Random Forest"</span>),</span>
<span id="cb72-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb72-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Metrics =</span> <span class="fu">c</span>(<span class="st">"Test Prop = 0.7"</span>,<span class="st">"CP = 0.045635"</span>, <span class="st">"Variance Explained: 42.2%"</span>),</span>
<span id="cb72-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb72-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">RMSE =</span> <span class="fu">c</span>(rmse2, rmseTree, rmseRandomTree))</span>
<span id="cb72-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#cb72-4" aria-hidden="true" tabindex="-1"></a>final_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Type                   Metrics      RMSE
1 Linear Regression           Test Prop = 0.7  913.4020
2  Regression Trees             CP = 0.045635 1022.5859
3     Random Forest Variance Explained: 42.2%  856.7104</code></pre>
</div>
</div>
<p>I would choose the Linear Regression model out of these three, even though the random forest has a lower RMSE less than half of the Variance is explained, which makes me believe that the Linear Regression model is more robust.</p>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#next-steps" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1-2" class="level3">
<h3 class="anchored" data-anchor-id="question-1-2">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-1-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>One aspect I could have really improved on is the EDA and trying to filter the data, I couldn’t figure out how to replace the NA values in the dataset, so I just dropped NA which probably isn’t the best thing to do to find the best results. I should have started earlier so I would have time to fix this problem in office hours.</p>
</section>
<section id="question-2-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2-2">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#question-2-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Two future work ideas related to this project that could be interesting is analyzing how the study was run to figure out why patients with IDs before 100 had such high influence points and why the patients with IDs after 312 were listed as NA for receiving a drug. Another thing would be if he drug isn’t effective, but we can see in the data that Albumin levels and the levels of other chemicals are correlated with surviving more days. It would be interesting to understand why this is the case and if their was a new drug that could increase these levels leading to better patient outcomes.</p>
</section>
</section>
<section id="sources" class="level2">
<h2 class="anchored" data-anchor-id="sources">Sources<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/8fe51745/#sources" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Clark, T. G., Bradburn, M. J., Love, S. B., &amp; Altman, D. G. (2003, July 21). Survival analysis part I: Basic concepts and first analyses. British journal of cancer. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2394262/</p>
<p>Mayo Foundation for Medical Education and Research. (2023, November 14). Primary biliary cholangitis. Mayo Clinic. https://www.mayoclinic.org/diseases-conditions/primary-biliary-cholangitis/symptoms-causes/syc-20376874</p>
<p>U.S. Department of Health and Human Services. (n.d.). Definition &amp; Facts of primary biliary cholangitis (primary biliary cirrhosis) - NIDDK. National Institute of Diabetes and Digestive and Kidney Diseases. https://www.niddk.nih.gov/health-information/liver-disease/primary-biliary-cholangitis/definition-facts</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "/home/jovyan/Stat131-Project-Colin-Asbill.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "/home/jovyan/Stat131-Project-Colin-Asbill.qmd"
    }, "*");
  }
</script>
</body></html>