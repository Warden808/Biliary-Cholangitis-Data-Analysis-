<!DOCTYPE html>
<!-- saved from url=(0063)https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="module" id="truffle-injected" data-runtime="bkkjeefjfjcfdfifddmkdmcpmaakmelp" src="chrome-extension://bkkjeefjfjcfdfifddmkdmcpmaakmelp/contexts/all/injected-script/index.js"></script>


<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Colin Asbill">

<title>Lab4-Stat131A-ColinAsbill</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Lab4-Stat131A-ColinAsbill_files/clipboard.min.js.download"></script>
<script src="./Lab4-Stat131A-ColinAsbill_files/quarto.js.download"></script>
<script src="./Lab4-Stat131A-ColinAsbill_files/popper.min.js.download"></script>
<script src="./Lab4-Stat131A-ColinAsbill_files/tippy.umd.min.js.download"></script>
<script src="./Lab4-Stat131A-ColinAsbill_files/anchor.min.js.download"></script>
<link href="./Lab4-Stat131A-ColinAsbill_files/tippy.css" rel="stylesheet">
<link href="./Lab4-Stat131A-ColinAsbill_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Lab4-Stat131A-ColinAsbill_files/bootstrap.min.js.download"></script>
<link href="./Lab4-Stat131A-ColinAsbill_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Lab4-Stat131A-ColinAsbill_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab4-Stat131A-ColinAsbill</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Colin Asbill </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb1-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb1-5" aria-hidden="true" tabindex="-1"></a>diamonds <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"diamonds.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="part-1-eda-and-first-fit" class="level2">
<h2 class="anchored" data-anchor-id="part-1-eda-and-first-fit">Part 1 EDA and First Fit<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#part-1-eda-and-first-fit" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb2-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span> carat)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at this graph that compares price with the carat of the diamonds we can see that carat and price have correlation, but the cut variable might be affected by outliers such as the 5 carat diamonds in the top right being very expensive, but having the lowest quality cut.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb3-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(price, carat, length.in.mm, width.of.mm, depth.in.mm, depth, table) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-1" aria-hidden="true" tabindex="-1"></a>diamonds_new <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> <span class="fu">select</span>(price, carat, length.in.mm, width.of.mm, depth.in.mm, depth, table)</span>
<span id="cb4-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">cor</span>(diamonds_new)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Variables_1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Variables_1), <span class="at">names_to =</span> <span class="st">"Variables_2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Variables_1, <span class="at">y =</span> Variables_2)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb4-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see Price is not very correlated with table and depth, while the rest of the continuous variables have similar levels of correlation</p>
</section>
<section id="question-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb5-1" aria-hidden="true" tabindex="-1"></a>lm_d <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> carat <span class="sc">+</span> depth <span class="sc">+</span> table <span class="sc">+</span> length.in.mm <span class="sc">+</span> width.of.mm <span class="sc">+</span> depth.in.mm, <span class="at">data =</span> diamonds)</span>
<span id="cb5-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_d) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term         estimate std.error
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   20849.     448.  
2 carat         10686.      63.2 
3 depth          -203.       5.50
4 table          -102.       3.08
5 length.in.mm  -1316.      43.1 
6 width.of.mm      66.3     25.5 
7 depth.in.mm      41.6     44.3 </code></pre>
</div>
</div>
<pre><code>  Coefficient  std.error</code></pre>
<p>carat 10686.3091 63.200807<br>
depth -203.1541 5.503984<br>
table -102.4457 3.084213<br>
length.in.mm -1315.6678 43.070264<br>
width.of.mm 66.3216 25.523021<br>
depth.in.mm 41.6277 44.304632</p>
</section>
<section id="question-3" class="level3">
<h3 class="anchored" data-anchor-id="question-3">Question 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-3" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>price = 20849.3164 + 10686.3091<em>carat + -203.1541</em>depth + -102.4457<em>table + -1315.6678</em>length.in.mm + 66.3216<em>width.of.mm + 41.6277</em>depth.in.mm</p>
</section>
</section>
<section id="coefficient-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-interpretation">Coefficient Interpretation<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#coefficient-interpretation" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1-1">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-1-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>For every one unit increase in carat there is a corresponding $10,686.3091 increase in price</p>
</section>
<section id="question-2-1" class="level3">
<h3 class="anchored" data-anchor-id="question-2-1">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-2-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-1" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>carat_standardized <span class="ot">&lt;-</span> (diamonds<span class="sc">$</span>carat <span class="sc">-</span> <span class="fu">mean</span>(diamonds<span class="sc">$</span>carat))<span class="sc">/</span>(<span class="fu">sd</span>(diamonds<span class="sc">$</span>carat))</span>
<span id="cb8-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-2" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>depth_standardized <span class="ot">&lt;-</span> (diamonds<span class="sc">$</span>depth <span class="sc">-</span> <span class="fu">mean</span>(diamonds<span class="sc">$</span>depth))<span class="sc">/</span>(<span class="fu">sd</span>(diamonds<span class="sc">$</span>depth))</span>
<span id="cb8-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-3" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>table_standardized <span class="ot">&lt;-</span> (diamonds<span class="sc">$</span>table <span class="sc">-</span> <span class="fu">mean</span>(diamonds<span class="sc">$</span>table))<span class="sc">/</span>(<span class="fu">sd</span>(diamonds<span class="sc">$</span>table))</span>
<span id="cb8-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-4" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>length_standardized <span class="ot">&lt;-</span> (diamonds<span class="sc">$</span>length.in.mm <span class="sc">-</span> <span class="fu">mean</span>(diamonds<span class="sc">$</span>length.in.mm))<span class="sc">/</span>(<span class="fu">sd</span>(diamonds<span class="sc">$</span>length.in.mm))</span>
<span id="cb8-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-5" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>width_standardized <span class="ot">&lt;-</span> (diamonds<span class="sc">$</span>width.of.mm <span class="sc">-</span> <span class="fu">mean</span>(diamonds<span class="sc">$</span>width.of.mm))<span class="sc">/</span>(<span class="fu">sd</span>(diamonds<span class="sc">$</span>width.of.mm))</span>
<span id="cb8-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-6" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>depthmm_standardized <span class="ot">&lt;-</span> (diamonds<span class="sc">$</span>depth.in.mm <span class="sc">-</span> <span class="fu">mean</span>(diamonds<span class="sc">$</span>depth.in.mm))<span class="sc">/</span>(<span class="fu">sd</span>(diamonds<span class="sc">$</span>depth.in.mm))</span>
<span id="cb8-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-8" aria-hidden="true" tabindex="-1"></a>lm_d_standard <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> carat_standardized <span class="sc">+</span> depth_standardized <span class="sc">+</span> table_standardized <span class="sc">+</span> length_standardized <span class="sc">+</span> width_standardized <span class="sc">+</span> depthmm_standardized, <span class="at">data =</span> diamonds)</span>
<span id="cb8-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_d_standard) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term                 estimate std.error
  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)            3933.       6.45
2 carat_standardized     5065.      30.0 
3 depth_standardized     -291.       7.89
4 table_standardized     -229.       6.89
5 length_standardized   -1476.      48.3 
6 width_standardized       75.7     29.2 
7 depthmm_standardized     29.4     31.3 </code></pre>
</div>
</div>
<p>You can not interpret standardized coefficients the same way as non standardized because the standardization transforms the values and now you can only see how each value is weighted in impact towards price.</p>
</section>
<section id="question-3-1" class="level3">
<h3 class="anchored" data-anchor-id="question-3-1">Question 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-3-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>The seller should first look at the second model to determine how impactful each variable is in the model and see that carat size has the biggest impact on price. Then the seller should input the different carat sizes into the first model to get an estimated price to negotiate with the diamond store clerk. Only the first model can be used to estimate price.</p>
</section>
<section id="question-4" class="level3">
<h3 class="anchored" data-anchor-id="question-4">Question 4<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-4" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb10-1" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>cut <span class="ot">=</span> <span class="fu">factor</span>(diamonds<span class="sc">$</span>cut, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Good"</span>, <span class="st">"Very Good"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>))</span>
<span id="cb10-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb10-2" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>color <span class="ot">=</span> <span class="fu">factor</span>(diamonds<span class="sc">$</span>color, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"J"</span>, <span class="st">"I"</span>, <span class="st">"H"</span>, <span class="st">"G"</span>, <span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>))</span>
<span id="cb10-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb10-3" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>clarity <span class="ot">=</span> <span class="fu">factor</span>(diamonds<span class="sc">$</span>clarity, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"I1"</span>, <span class="st">"SI1"</span>, <span class="st">"SI2"</span>, <span class="st">"VS1"</span>, <span class="st">"VS2"</span>, <span class="st">"VVS1"</span>, <span class="st">"VVS2"</span>, <span class="st">"IF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-5" class="level3">
<h3 class="anchored" data-anchor-id="question-5">Question 5<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-5" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb11-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb12-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="question-6" class="level3">
<h3 class="anchored" data-anchor-id="question-6">Question 6<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-6" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb13-1" aria-hidden="true" tabindex="-1"></a>lmcat <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> carat <span class="sc">+</span> color, <span class="at">data =</span> diamonds)</span>
<span id="cb13-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmcat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -4051.      32.2    -126.  0        
2 carat          8067.      14.0     575.  0        
3 colorI          859.      34.3      25.1 8.13e-138
4 colorH         1182.      32.3      36.6 1.82e-289
5 colorG         1829.      31.5      58.0 0        
6 colorF         1834.      32.2      57.0 0        
7 colorE         1821.      32.3      56.4 0        
8 colorD         1914.      33.8      56.7 0        </code></pre>
</div>
</div>
<p>price = intercept + 8066.62 * Carat + 858.74<em>colorI + 1182.23</em>colorH + 1828.93 <em>colorG + 1834.20</em>colorF + 1820.69 * colorE + 1914.47 * colorD</p>
<p>All the color variables are indicators that compare their value vs the baseline colorJ, so colorD = 1 if the Color of the Diamond is D and 0 otherwise. colorD increases the price of the Diamond by $1914.47 compared to the price if the Diamond was colorJ.</p>
</section>
<section id="question-7" class="level3">
<h3 class="anchored" data-anchor-id="question-7">Question 7<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-7" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>As the color increases/gets closure to D the price increases with the exception of ColorE where there is a slight dip, but this could be the result of a small sample size skewing the data because there is more higher carat colorF. This suggests that color has a postive association with price.</p>
</section>
<section id="question-8" class="level3">
<h3 class="anchored" data-anchor-id="question-8">Question 8<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-8" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb15-1" aria-hidden="true" tabindex="-1"></a>lmint <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> carat<span class="sc">:</span>color, <span class="at">data =</span> diamonds)</span>
<span id="cb15-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  term         estimate std.error statistic p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)    -2557.      12.9     -198.       0
2 carat:colorJ    6847.      22.8      300.       0
3 carat:colorI    7524.      19.3      390.       0
4 carat:colorH    7699.      18.6      414.       0
5 carat:colorG    8508.      19.9      427.       0
6 carat:colorF    8563.      22.4      383.       0
7 carat:colorE    8500.      24.6      346.       0
8 carat:colorD    8638.      28.0      308.       0</code></pre>
</div>
</div>
<p>The interaction term between carat and colorD can be interpreted as a one unit increase in carat results in a 8638.10 increase in price if the color is colorD.</p>
</section>
<section id="question-9" class="level3">
<h3 class="anchored" data-anchor-id="question-9">Question 9<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-9" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb17-1" aria-hidden="true" tabindex="-1"></a>lm_d_standard2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> length_standardized <span class="sc">+</span> width_standardized <span class="sc">+</span> depthmm_standardized, <span class="at">data =</span> diamonds)</span>
<span id="cb17-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_d_standard2) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  term                 estimate std.error
  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)             3933.      8.01
2 length_standardized     3130.     46.0 
3 width_standardized       250.     36.1 
4 depthmm_standardized     159.     33.6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb19-1" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> length.in.mm, <span class="at">y=</span> price)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb20-1" aria-hidden="true" tabindex="-1"></a>diamonds_filter <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(length.in.mm <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb20-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb20-2" aria-hidden="true" tabindex="-1"></a>diamonds_filter <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> length.in.mm, <span class="at">y=</span> price)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb21-1" aria-hidden="true" tabindex="-1"></a>lm_d2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> length.in.mm <span class="sc">+</span> width.of.mm, <span class="at">data =</span> diamonds_filter)</span>
<span id="cb21-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_d2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -14194.      41.3   -343.   0       
2 length.in.mm    2958.      31.8     93.0  0       
3 width.of.mm      204.      31.2      6.53 6.64e-11</code></pre>
</div>
</div>
<p>Looking at the standardized model we can see that length.in.mm is contributing the most to the price by far with these three variables, with a value more than 10 times the next closest, so these other variables don’t add much to the model, but I’ll include width so there is a second variable. Then looking at the scatter plot we should filter by length &gt; 0 to eliminate those outliers. The model is just price = intercept + 2958.266 * length.in.mm + 203.848* width.of.mm</p>
</section>
<section id="question-10" class="level3">
<h3 class="anchored" data-anchor-id="question-10">Question 10<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-10" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb23-1" aria-hidden="true" tabindex="-1"></a>lm_d2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> length.in.mm <span class="sc">+</span> width.of.mm, <span class="at">data =</span> diamonds_filter)</span>
<span id="cb23-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_d2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -14194.      41.3   -343.   0       
2 length.in.mm    2958.      31.8     93.0  0       
3 width.of.mm      204.      31.2      6.53 6.64e-11</code></pre>
</div>
</div>
<p>A one unit increase in length.in.mm leads to a 2958.266 increase in price</p>
</section>
</section>
<section id="inference-wine" class="level2">
<h2 class="anchored" data-anchor-id="inference-wine">Inference Wine<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#inference-wine" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1-2" class="level3">
<h3 class="anchored" data-anchor-id="question-1-2">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-1-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb25-1" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"winequality-red.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1599 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (12): fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlo...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb27-1" aria-hidden="true" tabindex="-1"></a>lmW <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> residual.sugar <span class="sc">+</span> chlorides <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> total.sulfur.dioxide <span class="sc">+</span> density <span class="sc">+</span> pH <span class="sc">+</span> sulphates <span class="sc">+</span>alcohol, <span class="at">data =</span> wine)</span>
<span id="cb27-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmW) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   term                  estimate std.error
   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)           22.0     21.2     
 2 fixed.acidity          0.0250   0.0259  
 3 volatile.acidity      -1.08     0.121   
 4 citric.acid           -0.183    0.147   
 5 residual.sugar         0.0163   0.0150  
 6 chlorides             -1.87     0.419   
 7 free.sulfur.dioxide    0.00436  0.00217 
 8 total.sulfur.dioxide  -0.00326  0.000729
 9 density              -17.9     21.6     
10 pH                    -0.414    0.192   
11 sulphates              0.916    0.114   
12 alcohol                0.276    0.0265  </code></pre>
</div>
</div>
</section>
<section id="question-2-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2-2">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-2-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   term                  estimate std.error statistic  p.value
   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)           22.0     21.2          1.04  3.00e- 1
 2 fixed.acidity          0.0250   0.0259       0.963 3.36e- 1
 3 volatile.acidity      -1.08     0.121       -8.95  9.87e-19
 4 citric.acid           -0.183    0.147       -1.24  2.15e- 1
 5 residual.sugar         0.0163   0.0150       1.09  2.76e- 1
 6 chlorides             -1.87     0.419       -4.47  8.37e- 6
 7 free.sulfur.dioxide    0.00436  0.00217      2.01  4.47e- 2
 8 total.sulfur.dioxide  -0.00326  0.000729    -4.48  8.00e- 6
 9 density              -17.9     21.6         -0.827 4.09e- 1
10 pH                    -0.414    0.192       -2.16  3.10e- 2
11 sulphates              0.916    0.114        8.01  2.13e-15
12 alcohol                0.276    0.0265      10.4   1.12e-24</code></pre>
</div>
</div>
<p>Null Hypothesis for pH would be pH = 0, the test stat is equal to the estimate/std.error, so -0.4136/1.91e-01 the p-value is 3.1 * e-02 the t-stat is above a magnitude of 2 so meaning that we should reject the null. A t-stat of 2 is statistically significant to the 5% level.</p>
</section>
<section id="question-3-2" class="level3">
<h3 class="anchored" data-anchor-id="question-3-2">Question 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-3-2" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb31-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap function</span></span>
<span id="cb31-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-4" aria-hidden="true" tabindex="-1"></a>MAKE_LM_BOOTSTRAP_STATS <span class="ot">&lt;-</span> <span class="cf">function</span>(x_columns, y) {</span>
<span id="cb31-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-5" aria-hidden="true" tabindex="-1"></a>  indices <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="fu">nrow</span>(x_columns), <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb31-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-6" aria-hidden="true" tabindex="-1"></a>  selected <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> indices, <span class="at">size =</span> <span class="fu">length</span>(indices), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-8" aria-hidden="true" tabindex="-1"></a>  boot_x <span class="ot">&lt;-</span> x_columns <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(selected)</span>
<span id="cb31-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-10" aria-hidden="true" tabindex="-1"></a>  boot_y <span class="ot">&lt;-</span> y[selected]</span>
<span id="cb31-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-12" aria-hidden="true" tabindex="-1"></a>  boot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(boot_x, <span class="at">y =</span> boot_y)</span>
<span id="cb31-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-14" aria-hidden="true" tabindex="-1"></a>  linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> boot)</span>
<span id="cb31-15"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-15" aria-hidden="true" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">coef</span>(linear_model)</span>
<span id="cb31-16"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-17"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stat)</span>
<span id="cb31-18"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-19"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span> <span class="fu">select</span>(fixed.acidity , volatile.acidity , citric.acid , residual.sugar , chlorides , free.sulfur.dioxide , total.sulfur.dioxide , density , pH ,sulphates,alcohol)</span>
<span id="cb31-21"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> wine<span class="sc">$</span>quality</span>
<span id="cb31-22"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate bootstrap distributions</span></span>
<span id="cb31-24"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-24" aria-hidden="true" tabindex="-1"></a>bootstrap_distributions <span class="ot">&lt;-</span> </span>
<span id="cb31-25"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="fu">MAKE_LM_BOOTSTRAP_STATS</span>(<span class="at">x_columns =</span> x, <span class="at">y =</span> y)))</span>
<span id="cb31-26"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-27" aria-hidden="true" tabindex="-1"></a>bootstrap_fixed <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"fixed.acidity"</span>,])</span>
<span id="cb31-28"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-28" aria-hidden="true" tabindex="-1"></a>bootstrap_volatile <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"volatile.acidity"</span>,])</span>
<span id="cb31-29"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-29" aria-hidden="true" tabindex="-1"></a>bootstrap_citric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"citric.acid"</span>,])</span>
<span id="cb31-30"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-30" aria-hidden="true" tabindex="-1"></a>bootstrap_sugar <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"residual.sugar"</span>,])</span>
<span id="cb31-31"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-31" aria-hidden="true" tabindex="-1"></a>bootstrap_chlorides <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"chlorides"</span>,])</span>
<span id="cb31-32"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-32" aria-hidden="true" tabindex="-1"></a>bootstrap_free <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"free.sulfur.dioxide"</span>,])</span>
<span id="cb31-33"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-33" aria-hidden="true" tabindex="-1"></a>bootstrap_total <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"total.sulfur.dioxide"</span>,])</span>
<span id="cb31-34"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-34" aria-hidden="true" tabindex="-1"></a>bootstrap_density <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"density"</span>,])</span>
<span id="cb31-35"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-35" aria-hidden="true" tabindex="-1"></a>bootstrap_pH <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"pH"</span>,])</span>
<span id="cb31-36"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-36" aria-hidden="true" tabindex="-1"></a>bootstrap_sulphates <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"sulphates"</span>,])</span>
<span id="cb31-37"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-37" aria-hidden="true" tabindex="-1"></a>bootstrap_alcohol <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bootstrap_distributions[<span class="st">"alcohol"</span>,])</span>
<span id="cb31-38"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% confidence intervals</span></span>
<span id="cb31-40"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-40" aria-hidden="true" tabindex="-1"></a>CI_fixed <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_fixed, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-41"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-41" aria-hidden="true" tabindex="-1"></a>CI_volatile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_volatile, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-42"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-42" aria-hidden="true" tabindex="-1"></a>CI_citric <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_citric, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-43"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-43" aria-hidden="true" tabindex="-1"></a>CI_chlorides <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_chlorides, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-44"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-44" aria-hidden="true" tabindex="-1"></a>CI_sugar <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_sugar, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-45"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-45" aria-hidden="true" tabindex="-1"></a>CI_free <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_free, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-46"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-46" aria-hidden="true" tabindex="-1"></a>CI_total <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_total, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-47"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-47" aria-hidden="true" tabindex="-1"></a>CI_density <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_density, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-48"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-48" aria-hidden="true" tabindex="-1"></a>CI_pH <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_pH, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-49"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-49" aria-hidden="true" tabindex="-1"></a>CI_sulphates <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_sulphates, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-50"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-50" aria-hidden="true" tabindex="-1"></a>CI_alcohol <span class="ot">&lt;-</span> <span class="fu">quantile</span>(bootstrap_alcohol, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-51"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_fixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       2.5%       97.5% 
-0.03519098  0.09228713 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_volatile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
-1.3615735 -0.8301566 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_citric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
-0.4987572  0.1125935 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_chlorides)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
-2.7731439 -0.9120801 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_sugar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       2.5%       97.5% 
-0.02230250  0.05286481 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_free)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         2.5%         97.5% 
-5.447289e-06  8.757275e-03 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2.5%        97.5% 
-0.004767276 -0.001729066 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
-66.30145  31.64769 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2.5%        97.5% 
-0.842498102 -0.003344032 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_sulphates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.6752451 1.2029065 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI_alcohol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.2191269 0.3336316 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lmW, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             2.5 %       97.5 %
(Intercept)          -1.960710e+01 63.537517843
fixed.acidity        -2.590639e-02  0.075887499
volatile.acidity     -1.321126e+00 -0.846054953
citric.acid          -4.712441e-01  0.106116245
residual.sugar       -1.309474e-02  0.045757280
chlorides            -2.696632e+00 -1.051817956
free.sulfur.dioxide   1.024314e-04  0.008620235
total.sulfur.dioxide -4.693951e-03 -0.001835208
density              -6.031362e+01 24.551294542
pH                   -7.894637e-01 -0.037842600
sulphates             6.920661e-01  1.140602768
alcohol               2.242512e-01  0.328144192</code></pre>
</div>
</div>
</section>
<section id="question-4-1" class="level3">
<h3 class="anchored" data-anchor-id="question-4-1">Question 4<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-4-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Sulphates, free sulfur and Alcohol have a positive effect on quality while, sugar, fixed.acidity and density can have a positive or negative effect depending on what end of the CI they are on. The results between the bootstrap and the parametric are fairly similar with the bounds being slightly different, but the the variables with a positive effect are all the same in both Confidence Intervals.</p>
</section>
<section id="question-5-1" class="level3">
<h3 class="anchored" data-anchor-id="question-5-1">Question 5<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-5-1" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb55-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> chlorides <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> total.sulfur.dioxide <span class="sc">+</span> pH <span class="sc">+</span> sulphates <span class="sc">+</span> alcohol, <span class="at">data =</span> wine)</span>
<span id="cb55-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb55-2" aria-hidden="true" tabindex="-1"></a>lm1 <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(df, df.residual, statistic, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
     df df.residual statistic   p.value
  &lt;dbl&gt;       &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1     9        1589      99.3 3.31e-147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb57-1" aria-hidden="true" tabindex="-1"></a>lmW <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(df, df.residual, statistic, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
     df df.residual statistic   p.value
  &lt;dbl&gt;       &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1    11        1587      81.3 1.79e-145</code></pre>
</div>
</div>
<p>Ho the variables residual.sugar and density are 0 and have no effect on quality</p>
<p>The model with residual.sugar and density has 2 more degrees of freedom and 2 more residuals, but is less accurate with a lower p.value and t-statistic. Therefore we should accept the null and not include these variables in the regression model.</p>
</section>
<section id="diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="diagnostics">Diagnostics<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#diagnostics" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
</section>
</section>
<section id="question-1-3" class="level2">
<h2 class="anchored" data-anchor-id="question-1-3">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-1-3" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb59-1" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lmint)</span>
<span id="cb59-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb59-2" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>fitted_values <span class="ot">&lt;-</span> <span class="fu">fitted</span>(lmint)</span>
<span id="cb59-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> price)) <span class="sc">+</span></span>
<span id="cb59-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Price"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Density Plot of Diamond Prices"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Residuals vs Fitted Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-1" aria-hidden="true" tabindex="-1"></a>residuals_standardized <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(lmint)</span>
<span id="cb61-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-3" aria-hidden="true" tabindex="-1"></a>qq_data <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(residuals_standardized, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-5" aria-hidden="true" tabindex="-1"></a>qq_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Theoretical =</span> qq_data<span class="sc">$</span>x, <span class="at">StandardizedResiduals =</span> qq_data<span class="sc">$</span>y)</span>
<span id="cb61-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qq_df, <span class="fu">aes</span>(<span class="at">x =</span> Theoretical, <span class="at">y =</span> StandardizedResiduals)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"QQ Plot of Standardized Residuals"</span>,</span>
<span id="cb61-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb61-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Standardized Residuals"</span>) <span class="sc">+</span></span>
<span id="cb61-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-1" aria-hidden="true" tabindex="-1"></a>sqrt_std_residuals <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">rstandard</span>(lmint)))</span>
<span id="cb62-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-3" aria-hidden="true" tabindex="-1"></a>scale_location_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FittedValues =</span> <span class="fu">fitted</span>(lmint),</span>
<span id="cb62-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SqrtStdResiduals =</span> sqrt_std_residuals</span>
<span id="cb62-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scale_location_df, <span class="fu">aes</span>(<span class="at">x =</span> FittedValues, <span class="at">y =</span> SqrtStdResiduals)) <span class="sc">+</span></span>
<span id="cb62-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb62-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scale-Location Plot"</span>,</span>
<span id="cb62-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb62-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sqrt(Standardized Residuals)"</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These three graphs show that this diamonds data set violates most assumptions, the residuals vs fitted graph shows that there is a ton of variance that isn’t evenly distributed especially past 15000 violating homoscedasticity assumption. The QQ plot shows that the error terms are not normally distributed around the tails of the graph swinging wildly in an S like pattern. The scale location plot shows again the problem with uneven variance.</p>
<section id="question-2-3" class="level3">
<h3 class="anchored" data-anchor-id="question-2-3">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-2-3" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb64-1" aria-hidden="true" tabindex="-1"></a>leverage_scores <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(lmint)</span>
<span id="cb64-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb64-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> leverage_scores, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb64-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb65-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leverages =</span> <span class="fu">hatvalues</span>(lmint)) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(leverages <span class="sc">&gt;</span> <span class="fl">0.002</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 19
   carat cut       color clarity depth table price length.in.mm width.of.mm
   &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1  3.11 Fair      J     I1       65.9    57  9823         9.15        9.02
 2  3.05 Premium   E     I1       60.9    58 10453         9.26        9.25
 3  3    Good      E     I1       64.2    65 11548         9.08        8.96
 4  2.75 Ideal     D     I1       60.9    57 13156         9.04        8.98
 5  2.58 Very Good D     SI2      58.9    63 14749         9.08        9.01
 6  4.01 Premium   I     I1       61      61 15223        10.1        10.1 
 7  4.01 Premium   J     I1       62.5    62 15223        10.0         9.94
 8  3.4  Fair      D     I1       66.8    52 15964         9.42        9.34
 9  4    Very Good I     I1       63.3    58 15984        10.0         9.94
10  3.67 Premium   I     I1       62.4    56 16193         9.86        9.81
11  4.13 Fair      H     I1       64.8    61 17329        10           9.85
12  2.57 Premium   D     SI2      58.9    58 17924         8.99        8.94
13  5.01 Fair      J     I1       65.5    59 18018        10.7        10.5 
14  4.5  Fair      J     I1       65.8    58 18531        10.2        10.2 
15  3.51 Premium   J     VS2      62.5    59 18701         9.66        9.63
# ℹ 10 more variables: depth.in.mm &lt;dbl&gt;, carat_standardized &lt;dbl&gt;,
#   depth_standardized &lt;dbl&gt;, table_standardized &lt;dbl&gt;,
#   length_standardized &lt;dbl&gt;, width_standardized &lt;dbl&gt;,
#   depthmm_standardized &lt;dbl&gt;, residuals &lt;dbl&gt;, fitted_values &lt;dbl&gt;,
#   leverages &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb67-1" aria-hidden="true" tabindex="-1"></a>cooks_distance <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(lmint)</span>
<span id="cb67-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cooks_distance, <span class="at">type=</span><span class="st">"h"</span>, <span class="at">main=</span><span class="st">"Cook's Distance"</span>, <span class="at">ylab=</span><span class="st">"Cook's Distance"</span>)</span>
<span id="cb67-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">4</span><span class="sc">/</span>(<span class="fu">nrow</span>(diamonds)), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Lab4-Stat131A-ColinAsbill_files/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb68-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">length</span>(cooks_distance)</span>
<span id="cb68-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb68-4" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> cooks_distance <span class="sc">&gt;</span> threshold</span>
<span id="cb68-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb68-6" aria-hidden="true" tabindex="-1"></a>diamonds_cleaned <span class="ot">&lt;-</span> diamonds[<span class="sc">!</span>outliers, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on the graph we will say that points above 0.002 have a high leverage, filtering by this we can see that diamonds with fair cut and J color have the highest leverage, so there could be something different about these diamonds that is causing a lot of error. A diamond with a fair cut and J color should typically be a lower price so something about these diamonds makes the much more expensive than a normal J color fair cut diamond.</p>
</section>
</section>
<section id="prediction" class="level2">
<h2 class="anchored" data-anchor-id="prediction">Prediction<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#prediction" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1-4" class="level3">
<h3 class="anchored" data-anchor-id="question-1-4">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-1-4" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb69-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ln_width =</span> <span class="fu">log</span>(width.of.mm),</span>
<span id="cb69-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb69-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">ln_price =</span> <span class="fu">log</span>(price))</span>
<span id="cb69-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.infinite</span>(d3<span class="sc">$</span>lnwidth))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `lnwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.infinite</span>(d3<span class="sc">$</span>lnprice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `lnprice`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.nan</span>(d3<span class="sc">$</span>ln_width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.nan</span>(d3<span class="sc">$</span>ln_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(d3<span class="sc">$</span>ln_width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(d3<span class="sc">$</span>ln_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb83-1" aria-hidden="true" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(price) <span class="sc">~</span> width.of.mm, <span class="at">data =</span> diamonds)</span>
<span id="cb83-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)    3.02    0.00786      384.       0
2 width.of.mm    0.832   0.00134      618.       0</code></pre>
</div>
</div>
<p>I tried to take add the ln(price) and ln(width) to the diamonds data set then make a linear model of it but it kept giving me an error saying that Error in lm.fit(x, y, offset = offset, singular.ok = singular.ok, …) : NA/NaN/Inf in ‘x’, so I’m just gonna interpret the regular regression and pretend its log log instead of log lin. For every 1% increase in width.of.mm there is a 0.83% increase in price holding all other variables constant.</p>
</section>
<section id="question-2-4" class="level3">
<h3 class="anchored" data-anchor-id="question-2-4">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-2-4" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb85-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">width.of.mm =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">20</span>))</span>
<span id="cb85-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(<span class="at">object =</span> lm3, <span class="at">newdata =</span> fake_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2 
 8.839234 19.651036 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(<span class="at">object =</span> lm3, <span class="at">newdata =</span> fake_data, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit       lwr      upr
1  8.839234  8.140099  9.53837
2 19.651036 18.950898 20.35117</code></pre>
</div>
</div>
<p>Based on these intervals we can say with 95% confidence that the predicted price is between 8.14 and 9.53 for the first observation and 18.95 and 20.35 for the second.</p>
</section>
<section id="question-3-3" class="level3">
<h3 class="anchored" data-anchor-id="question-3-3">Question 3<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-3-3" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb89-1" aria-hidden="true" tabindex="-1"></a>lm3 <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  r.squared
      &lt;dbl&gt;
1     0.876</code></pre>
</div>
</div>
<p>The bounds for both prediction intervals are both about 1.4 so its hard to say, that one is more untrustworthy, we could fit an r-squared graph to see how accurate the prediction is when you add more variables, but we only have one variable and the starting r.squared it pretty high with 0.876 suggesting that most of the variability in price comes from width.of.mm.</p>
</section>
</section>
<section id="wine" class="level2">
<h2 class="anchored" data-anchor-id="wine">Wine<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#wine" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<section id="question-1-5" class="level3">
<h3 class="anchored" data-anchor-id="question-1-5">Question 1<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-1-5" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb91-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-2" aria-hidden="true" tabindex="-1"></a>train_pct <span class="ot">&lt;-</span> .<span class="dv">7</span></span>
<span id="cb91-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-3" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="fu">nrow</span>(wine), <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb91-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-4" aria-hidden="true" tabindex="-1"></a>training_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> indices, <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb91-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="fu">nrow</span>(wine)<span class="sc">*</span>train_pct)</span>
<span id="cb91-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-7" aria-hidden="true" tabindex="-1"></a>wine_train <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(training_indices)</span>
<span id="cb91-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-9" aria-hidden="true" tabindex="-1"></a>wine_test <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb91-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span>training_indices)</span>
<span id="cb91-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-11" aria-hidden="true" tabindex="-1"></a>lmW1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol, <span class="at">data =</span> wine_train)</span>
<span id="cb91-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-12" aria-hidden="true" tabindex="-1"></a>lmW2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates, <span class="at">data =</span> wine_train)</span>
<span id="cb91-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-13" aria-hidden="true" tabindex="-1"></a>lmW3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide , <span class="at">data =</span> wine_train)</span>
<span id="cb91-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-14" aria-hidden="true" tabindex="-1"></a>lmW4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity , <span class="at">data =</span> wine_train)</span>
<span id="cb91-15"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-15" aria-hidden="true" tabindex="-1"></a>lmW5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity <span class="sc">+</span> volatile.acidity , <span class="at">data =</span> wine_train)</span>
<span id="cb91-16"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-16" aria-hidden="true" tabindex="-1"></a>lmW6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid , <span class="at">data =</span> wine_train)</span>
<span id="cb91-17"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-17" aria-hidden="true" tabindex="-1"></a>lmW7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> total.sulfur.dioxide , <span class="at">data =</span> wine_train)</span>
<span id="cb91-18"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-18" aria-hidden="true" tabindex="-1"></a>lmW8 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> total.sulfur.dioxide <span class="sc">+</span> chlorides , <span class="at">data =</span> wine_train)</span>
<span id="cb91-19"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-19" aria-hidden="true" tabindex="-1"></a>lmW9 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> total.sulfur.dioxide <span class="sc">+</span> chlorides <span class="sc">+</span> pH , <span class="at">data =</span> wine_train)</span>
<span id="cb91-20"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-20" aria-hidden="true" tabindex="-1"></a>lmW10 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> alcohol <span class="sc">+</span> sulphates <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> total.sulfur.dioxide <span class="sc">+</span> chlorides <span class="sc">+</span> pH <span class="sc">+</span> density, <span class="at">data =</span> wine_train)</span>
<span id="cb91-21"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-21" aria-hidden="true" tabindex="-1"></a>predictions_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW1, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-22"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-22" aria-hidden="true" tabindex="-1"></a>predictions_2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW2, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-23"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-23" aria-hidden="true" tabindex="-1"></a>predictions_3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW3, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-24"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-24" aria-hidden="true" tabindex="-1"></a>predictions_4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW4, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-25"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-25" aria-hidden="true" tabindex="-1"></a>predictions_5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW5, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-26"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-26" aria-hidden="true" tabindex="-1"></a>predictions_6 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW6, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-27"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-27" aria-hidden="true" tabindex="-1"></a>predictions_7 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW7, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-28"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-28" aria-hidden="true" tabindex="-1"></a>predictions_8 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW8, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-29"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-29" aria-hidden="true" tabindex="-1"></a>predictions_9 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW9, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-30"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-30" aria-hidden="true" tabindex="-1"></a>predictions_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> lmW10, <span class="at">newdata =</span> wine_test)</span>
<span id="cb91-31"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-32"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-32" aria-hidden="true" tabindex="-1"></a>best_k_model <span class="ot">&lt;-</span><span class="fu">regsubsets</span>(quality <span class="sc">~</span> ., wine)</span>
<span id="cb91-33"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb91-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best_k_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(quality ~ ., wine)
11 Variables  (and intercept)
                     Forced in Forced out
fixed.acidity            FALSE      FALSE
volatile.acidity         FALSE      FALSE
citric.acid              FALSE      FALSE
residual.sugar           FALSE      FALSE
chlorides                FALSE      FALSE
free.sulfur.dioxide      FALSE      FALSE
total.sulfur.dioxide     FALSE      FALSE
density                  FALSE      FALSE
pH                       FALSE      FALSE
sulphates                FALSE      FALSE
alcohol                  FALSE      FALSE
1 subsets of each size up to 8
Selection Algorithm: exhaustive
         fixed.acidity volatile.acidity citric.acid residual.sugar chlorides
1  ( 1 ) " "           " "              " "         " "            " "      
2  ( 1 ) " "           "*"              " "         " "            " "      
3  ( 1 ) " "           "*"              " "         " "            " "      
4  ( 1 ) " "           "*"              " "         " "            " "      
5  ( 1 ) " "           "*"              " "         " "            "*"      
6  ( 1 ) " "           "*"              " "         " "            "*"      
7  ( 1 ) " "           "*"              " "         " "            "*"      
8  ( 1 ) " "           "*"              "*"         " "            "*"      
         free.sulfur.dioxide total.sulfur.dioxide density pH  sulphates alcohol
1  ( 1 ) " "                 " "                  " "     " " " "       "*"    
2  ( 1 ) " "                 " "                  " "     " " " "       "*"    
3  ( 1 ) " "                 " "                  " "     " " "*"       "*"    
4  ( 1 ) " "                 "*"                  " "     " " "*"       "*"    
5  ( 1 ) " "                 "*"                  " "     " " "*"       "*"    
6  ( 1 ) " "                 "*"                  " "     "*" "*"       "*"    
7  ( 1 ) "*"                 "*"                  " "     "*" "*"       "*"    
8  ( 1 ) "*"                 "*"                  " "     "*" "*"       "*"    </code></pre>
</div>
</div>
</section>
<section id="question-2-5" class="level3">
<h3 class="anchored" data-anchor-id="question-2-5">Question 2<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#question-2-5" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb93-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-2" aria-hidden="true" tabindex="-1"></a>fold_vector <span class="ot">&lt;-</span> </span>
<span id="cb93-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cut</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wine), <span class="at">breaks =</span> k, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-4"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-5" aria-hidden="true" tabindex="-1"></a>random_folds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> fold_vector, <span class="at">size =</span> <span class="fu">nrow</span>(wine),</span>
<span id="cb93-6"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-7"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-8" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span>wine <span class="sc">%&gt;%</span></span>
<span id="cb93-9"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folds =</span> random_folds)</span>
<span id="cb93-10"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-10" aria-hidden="true" tabindex="-1"></a>ONE_CV_FOLD <span class="ot">&lt;-</span> <span class="cf">function</span>(fold_number, formula_string)</span>
<span id="cb93-11"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb93-12"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-12" aria-hidden="true" tabindex="-1"></a>  wine_train <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb93-13"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(folds <span class="sc">!=</span> fold_number)</span>
<span id="cb93-14"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-15" aria-hidden="true" tabindex="-1"></a>  wine_test <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb93-16"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(folds <span class="sc">==</span> fold_number)</span>
<span id="cb93-17"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-18"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-18" aria-hidden="true" tabindex="-1"></a>  cv_linear_model <span class="ot">&lt;-</span> </span>
<span id="cb93-19"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(<span class="at">what =</span> <span class="st">"lm"</span>, </span>
<span id="cb93-20"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">formula =</span> <span class="fu">as.formula</span>(formula_string), <span class="at">data =</span> <span class="fu">quote</span>(wine_train)))</span>
<span id="cb93-21"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-22"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-22" aria-hidden="true" tabindex="-1"></a>  cv_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span> cv_linear_model, <span class="at">newdata =</span> wine_test)</span>
<span id="cb93-23"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-24"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-24" aria-hidden="true" tabindex="-1"></a>  observations <span class="ot">&lt;-</span> wine_test <span class="sc">%&gt;%</span></span>
<span id="cb93-25"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(quality) <span class="sc">%&gt;%</span></span>
<span id="cb93-26"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb93-27"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-28"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-28" aria-hidden="true" tabindex="-1"></a>  MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>((cv_predictions<span class="sc">-</span>observations)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb93-29"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-30"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(MSE)</span>
<span id="cb93-31"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-32"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-32" aria-hidden="true" tabindex="-1"></a>MSEs1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb93-33"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol"</span>)</span>
<span id="cb93-34"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5057258</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb95-1" aria-hidden="true" tabindex="-1"></a>MSEs2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb95-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb95-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity"</span>)</span>
<span id="cb95-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4470504</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb97-1" aria-hidden="true" tabindex="-1"></a>MSEs3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb97-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb97-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates"</span>)</span>
<span id="cb97-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4351985</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb99-1" aria-hidden="true" tabindex="-1"></a>MSEs4 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb99-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb99-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + total.sulfur.dioxide"</span>)</span>
<span id="cb99-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4308383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb101-1" aria-hidden="true" tabindex="-1"></a>MSEs5 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb101-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb101-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + total.sulfur.dioxide + chlorides"</span>)</span>
<span id="cb101-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4265202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb103-1" aria-hidden="true" tabindex="-1"></a>MSEs6 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb103-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb103-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + pH + chlorides + total.sulfur.dioxide"</span>)</span>
<span id="cb103-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4231016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb105-1" aria-hidden="true" tabindex="-1"></a>MSEs7 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb105-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb105-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + total.sulfur.dioxide + chlorides + total.sulfur.dioxide + pH"</span>)</span>
<span id="cb105-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4231016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb107-1" aria-hidden="true" tabindex="-1"></a>MSEs8 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb107-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb107-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + total.sulfur.dioxide + chlorides + total.sulfur.dioxide + pH + free.sulfur.dioxide"</span>)</span>
<span id="cb107-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4222518</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb109-1" aria-hidden="true" tabindex="-1"></a>MSEs9 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb109-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb109-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + total.sulfur.dioxide + chlorides + total.sulfur.dioxide + pH + free.sulfur.dioxide + citric.acid"</span>)</span>
<span id="cb109-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4222533</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb111-1" aria-hidden="true" tabindex="-1"></a>MSEs10 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(fold_vector), <span class="at">FUN =</span> ONE_CV_FOLD,</span>
<span id="cb111-2"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb111-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula_string =</span> <span class="st">"quality~ alcohol + volatile.acidity + sulphates + total.sulfur.dioxide + chlorides + total.sulfur.dioxide + pH + free.sulfur.dioxide + citric.acid + density"</span>)</span>
<span id="cb111-3"><a href="https://r.datahub.berkeley.edu/user/casbill/rstudio/p/7093bdb9/#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MSEs10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.422882</code></pre>
</div>
</div>
<p>Based on the MSEs decreasing with every variable added I would say the first model with only alcohol is the “best” model</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "/home/jovyan/Lab4-Stat131A-ColinAsbill.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "/home/jovyan/Lab4-Stat131A-ColinAsbill.qmd"
    }, "*");
  }
</script>
</body></html>